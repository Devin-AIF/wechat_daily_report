<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[在此处填写报告标题] - [日期]</title>
    <link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/tailwindcss/2.2.19/tailwind.min.css">
    <link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-100-M/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" xintegrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoVBL5rLesXWW/sGuLhYFChxgYnz2Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
        :root {
            /* Apple-inspired Tech Style Palette */
            --bg-primary: #f9f9f9;         /* Light Gray, almost white */
            --bg-secondary: #ffffff;       /* White - for cards */
            --bg-tertiary: #efeff0;       /* Slightly darker gray for tags/subtle elements */
            --text-primary: #1d1d1f;       /* Apple's typical black/dark gray */
            --text-secondary: #6e6e73;     /* Apple's medium gray */
            --accent-primary: #007aff;     /* Apple Blue */
            --accent-secondary: #0056b3;   /* Darker Apple Blue for hover */
            --accent-tertiary: #c7c7cc;    /* Light Gray - for borders or subtle elements */
            
            --accent-purple: #5856d6;      /* Apple's Indigo (for WordCloud or secondary accents) */
            --accent-cyan: #5ac8fa;        /* Apple's Light Blue (for WordCloud or tertiary accents) */

            --highlight-keyword-bg: rgba(0, 122, 255, 0.1); /* Light Apple Blue transparent */
            --highlight-name-color: var(--accent-primary);

            --card-padding: 20px;          /* Adjusted card padding */
            --grid-gap: 20px;              /* Adjusted grid gap */
            --card-radius: 10px;           /* Apple-like card radius */
            --card-shadow: 0 2px 8px rgba(0, 0, 0, 0.08); /* Softer, more diffused shadow */
            --font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Helvetica, Arial, sans-serif; /* Prioritize Apple system fonts */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 16px;
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        h1, h2, h3, h4 {
            font-weight: 600;
            letter-spacing: 0.25px; /* Adjusted for SF fonts */
        }

        h1 {
            font-size: 2.25rem; /* Slightly adjusted */
            margin-bottom: 0.5rem;
            color: var(--text-primary); /* Main titles are typically dark */
        }

        h2 { /* H2 general style, also used for topic cards */
            font-size: 1.6rem; /* Slightly adjusted */
            margin-bottom: 1rem;
            color: var(--text-primary); /* Section titles dark */
            display: flex; /* Added for icon alignment */
            align-items: center; /* Added for icon alignment */
        }
        
        h2 > .fas, h2 > .fa { /* Styling for icons directly within h2 */
            color: var(--accent-primary); /* Blue icon */
            margin-right: 10px;
            font-size: 0.9em; /* Make icon size relative to h2 */
        }

        h3 { /* Used for subheadings or specific elements like stats card */
            font-size: 1.2rem; /* Slightly adjusted */
            margin-bottom: 0.75rem;
            color: var(--accent-primary); /* Sub-titles can use accent */
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(12, 1fr); /* 12-column grid system */
            grid-auto-rows: minmax(100px, auto); /* Row height adjusts to content, min 100px */
            gap: var(--grid-gap);
            margin-top: 20px;
            grid-template-areas: /* Updated grid areas */
                "main      main      main      main      main      main      main      main      main      main      main      main"
                "topics    topics    topics    topics    topics    topics    topics    topics    topics    topics    topics    topics"
                "quote     quote     quote     quote     quote     quote     links     links     links     links     links     links"
                "stats     stats     stats     stats     stats     stats     stats     wordcloud wordcloud wordcloud wordcloud wordcloud";
        }

        .card {
            background-color: var(--bg-secondary);
            border-radius: var(--card-radius);
            padding: var(--card-padding);
            box-shadow: var(--card-shadow);
            position: relative; /* For icon positioning and pseudo-elements */
            overflow: hidden; /* Ensures pseudo-elements don't exceed card radius */
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex; /* Added for flex layout within cards */
            flex-direction: column; /* Stack items vertically */
        }

        .card:hover {
            transform: translateY(-4px); /* Subtle hover effect */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); /* Enhanced shadow on hover */
        }

        /* Removed .card::before (orange top border) for a cleaner Apple look */

        /* Decorative icon at the bottom right of cards */
        .card-icon {
            position: absolute;
            bottom: var(--card-padding);
            right: var(--card-padding);
            font-size: 3.5rem; /* Slightly smaller */
            opacity: 0.15; /* More subtle */
            color: var(--accent-tertiary); /* Light gray icon */
        }

        /* Grid area assignments */
        .main-card { grid-area: main; }
        .topic-cards-wrapper {
            grid-area: topics;
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: var(--grid-gap);
        }
        .quote-card { grid-area: quote; }
        .links-card { grid-area: links; }
        .stats-card { grid-area: stats; }
        .wordcloud-card { grid-area: wordcloud; }

        /* Styling for individual topic cards within topic-cards-wrapper */
        .topic-card {
            grid-column: span 6; /* Default to occupying 6 columns */
            min-height: 250px;
        }
        .topic-card > .topic-card-content-wrapper {
            flex-grow: 1; /* Allows content area to fill remaining card space */
            padding-bottom: 1rem; /* Common bottom padding for content area */
        }

        /* If there's an odd number of topic cards, the last one spans the full row */
        .topic-cards-wrapper > .topic-card:nth-last-child(1):nth-child(odd) {
            grid-column: span 12;
        }

        .main-card h1 {
            text-align: center;
        }
        .main-card .date {
            text-align: center;
        }

        .date {
            font-size: 1rem; /* Adjusted */
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .meta-info {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 1rem;
            justify-content: center;
        }

        .meta-info span {
            background-color: var(--bg-tertiary);
            padding: 6px 12px; /* Adjusted padding */
            border-radius: 20px; /* Pill shape */
            font-size: 0.85rem; /* Adjusted */
            color: var(--text-secondary); /* Text color gray */
            display: inline-flex; /* Align icon and text */
            align-items: center;
        }
        .meta-info span i {
            color: var(--accent-primary); /* Icon color blue */
            margin-right: 6px;
        }


        .summary {
            margin-top: 1rem;
            line-height: 1.65; /* Slightly adjusted for readability */
            text-align: left; /* Summary text left-aligned */
            color: var(--text-secondary);
        }

        .topic-category {
            display: inline-block; /* Background fits text content */
            background-color: rgba(0, 122, 255, 0.1); /* Light blue background */
            color: var(--accent-primary); /* Blue text */
            padding: 5px 10px; /* Adjusted padding */
            border-radius: 6px; /* Softer radius */
            font-size: 0.75rem; /* Adjusted */
            font-weight: 500;
            margin-bottom: 0.75rem; /* Increased margin */
        }

        .topic-keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 0.75rem;
            margin-bottom: 0.75rem; /* Spacing between keywords and mentions */
        }

        .keyword {
            background-color: var(--bg-tertiary);
            color: var(--text-secondary); /* More subtle keywords */
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.8rem;
        }
        .highlight-keyword {
            background-color: var(--highlight-keyword-bg);
            color: var(--accent-primary);
            padding: 2px 4px;
            border-radius: 4px; /* Consistent radius */
            font-weight: 500;
        }
        .highlight-name {
            color: var(--highlight-name-color);
            font-weight: 600; /* Emphasize names more */
        }

        .topic-mentions {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        .topic-mentions i { /* Icon within mentions */
             color: var(--text-secondary); /* Match text color */
             margin-right: 4px;
        }


        .quote {
            position: relative;
            padding-left: 20px; 
            margin: 15px 0; /* Increased margin */
            font-style: normal; /* Apple quotes often not italic */
            color: var(--text-secondary);
            border-left: 3px solid var(--accent-tertiary); /* Subtle left border */
        }

        /* Removed .quote::before for a cleaner look with border-left */

        .quote-author {
            text-align: right;
            font-size: 0.9rem;
            color: var(--text-primary); /* Author name darker */
            font-style: normal; /* Not italic */
            margin-top: 8px;
        }

        .link-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px; /* Increased padding */
            border-radius: 8px; /* Consistent radius */
            background-color: transparent; /* Cleaner look, hover provides feedback */
            transition: background-color 0.2s ease;
            text-decoration: none; /* Remove underline from outer div */
        }

        .link-item:hover {
            background-color: var(--bg-tertiary); /* Subtle background on hover */
        }
        
        .link-item a { /* Make entire link item clickable */
            text-decoration: none;
            color: inherit; /* Inherit color from parent */
            display: flex; /* Align internal elements */
            align-items: center;
            width: 100%;
        }

        .link-item a:hover .link-title { /* Underline title on hover only */
            text-decoration: underline;
            color: var(--accent-primary); /* Keep link hover color consistent */
        }


        .link-icon {
            margin-right: 12px; /* Increased margin */
            color: var(--accent-primary);
        }

        .link-title {
            flex-grow: 1; /* Occupy remaining space */
            color: var(--text-primary); /* Default link title color */
        }
        
        .link-title.is-link { /* If it's an actual link, use accent color */
            color: var(--accent-primary);
        }
        .link-title.is-link:hover {
            text-decoration: underline;
        }

        .user-stats-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 0.75rem; /* Adjusted spacing from title */
        }
        .user-stats-table th {
            text-align: left; /* Apple tables often left-align headers */
            padding: 0.85rem 0.5rem;  /* Adjusted padding */
            border-bottom: 1px solid var(--bg-tertiary); /* Thinner, lighter border */
            color: var(--text-secondary); /* Lighter header text */
            font-weight: 500; /* Medium weight */
            font-size: 0.8rem; 
            text-transform: uppercase; /* Uppercase for headers */
        }
        .user-stats-table td {
            padding: 0.85rem 0.5rem; 
            border-bottom: 1px solid var(--bg-tertiary);
            color: var(--text-primary); /* Darker cell text */
            font-size: 0.85rem; 
            vertical-align: top; 
            text-align: left; /* Cell content left-aligned */
        }
        .user-stats-table .user-name-col { 
            width: 25%;
            font-weight: 500; 
            color: var(--text-primary);
            word-break: break-all; /* Allow long usernames to wrap */
        }
        .user-stats-table .message-count-col {
            text-align: center; /* Message count centered */
            width: 15%;
            white-space: nowrap; /* Keep message count on one line */
        }
        .user-stats-table .contribution-col { 
            width: 60%;
            word-break: break-all; /* Allow contribution text to wrap */
            color: var(--text-secondary); /* Contribution text slightly lighter */
        }
        .user-stats-table tr:last-child td {
            border-bottom: none;
        }

        .wordcloud {
            display: flex;
            flex-wrap: wrap;
            justify-content: center; /* Center-align word cloud */
            gap: 12px; /* Adjusted gap */
            padding: 20px 0;
        }

        .wordcloud-item {
            padding: 6px 12px; /* Adjusted padding */
            border-radius: 6px;
            font-weight: 500;
            transition: transform 0.2s ease;
        }

        .wordcloud-item:hover {
            transform: scale(1.05); /* Slightly more subtle hover */
        }

        /* Word Cloud Font Sizes and Colors - Apple Palette */
        .size-1 { font-size: 0.9rem; color: var(--text-secondary); } /* Gray for smallest */
        .size-2 { font-size: 1.1rem; color: var(--accent-cyan); }    /* Light Blue */
        .size-3 { font-size: 1.3rem; color: var(--accent-primary); } /* Standard Blue */
        .size-4 { font-size: 1.5rem; color: var(--accent-purple); }  /* Indigo/Purple for contrast */
        .size-5 { font-size: 1.8rem; color: var(--text-primary); font-weight: 600; } /* Darkest for largest */
        
        .action-buttons-container {
            text-align: center;
            margin: 25px 0; /* Adjusted margin */
            padding-bottom: 20px; /* Bottom spacing */
        }

        .action-button {
            background-color: var(--accent-primary);
            color: white;
            border: none;
            padding: 10px 18px; /* Adjusted padding */
            border-radius: 8px; /* Apple-like button radius */
            font-size: 0.95rem; /* Adjusted font size */
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.15s ease; /* Faster transitions */
            margin: 5px 8px; /* Adjusted margin */
            box-shadow: none; /* Flat buttons, no shadow */
            display: inline-flex; /* For icon and text alignment */
            align-items: center; /* Vertically center icon and text */
            justify-content: center; /* Horizontally center content */
        }

        .action-button:hover {
            background-color: var(--accent-secondary); /* Darker blue on hover */
            transform: translateY(-1px); /* Subtle lift */
        }
         .action-button i { /* Spacing for FontAwesome icons */
            margin-right: 8px;
        }
         .action-button .fas { /* Compatibility for older FontAwesome usage */
            margin-right: 8px;
        }


        .footer {
            margin-top: 30px; /* Spacing above footer */
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.85rem; /* Slightly smaller footer text */
        }
         #report-content-wrapper .footer { /* Ensures footer is included in screenshot */
            margin-top: 30px; /* Adjust spacing from content above */
            padding-bottom: 20px; /* Add bottom padding for screenshot completeness */
        }


        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); } /* Slightly adjusted animation */
            to { opacity: 1; transform: translateY(0); }
        }

        .card { animation: fadeIn 0.4s ease-out forwards; } /* Apply fade-in animation to all cards, adjusted timing */

        /* Animation delays for cards to appear sequentially */
        .main-card { animation-delay: 0.05s; }
        .topic-cards-wrapper .topic-card:nth-child(1) { animation-delay: 0.1s; }
        .topic-cards-wrapper .topic-card:nth-child(2) { animation-delay: 0.15s; }
        .topic-cards-wrapper .topic-card:nth-child(3) { animation-delay: 0.2s; }
        .topic-cards-wrapper .topic-card:nth-child(4) { animation-delay: 0.25s; } 
        
        .quote-card { animation-delay: 0.3s; } 
        .links-card { animation-delay: 0.35s; }
        .stats-card { animation-delay: 0.4s; }
        .wordcloud-card { animation-delay: 0.45s; }
        #report-content-wrapper .footer { animation-delay: 0.5s; } 
        .action-buttons-container { animation-delay: 0.55s; opacity: 0; animation: fadeIn 0.4s ease-out 0.55s forwards; } /* Ensure buttons also fade in */


        /* Mobile Responsive Styles */
        @media (max-width: 768px) { 
            body {
                padding: 15px; /* Slightly more padding on mobile */
                font-size: 15px; /* Mobile base font size */
            }

            h1 { font-size: 1.7rem; }
            h2 { font-size: 1.3rem; } 
            h3 { font-size: 1.05rem; }

            .grid-container {
                grid-template-columns: 1fr; /* Single column layout */
                grid-template-areas: /* Stack all areas vertically */
                    "main"
                    "topics"
                    "quote"
                    "links"
                    "stats"
                    "wordcloud";
            }
            
            .topic-cards-wrapper {
                grid-template-columns: 1fr; /* Topic cards also single column */
            }
            .topic-card { 
                grid-column: 1 / -1; /* Topic card spans full row */
                min-height: auto; /* Auto height */
            }
            .topic-card > .topic-card-content-wrapper {
                padding-bottom: 1rem; /* Ensure space at bottom of content */
            }
            .topic-mentions { /* Mentions count adjustments on mobile */
                position: static; /* Restore normal flow layout */
                margin-top: 10px; /* Spacing from content above */
                margin-bottom: 10px; /* Spacing from content below */
                text-align: left; /* Left-align */
            }
            .card-icon { /* Card icon adjustments on mobile */
                position: relative; /* Restore normal flow layout */
                bottom: auto;
                right: auto;
                margin-top: auto; /* Push to bottom */
                margin-left: auto; /* Push to right */
                padding-top: 10px; /* Spacing from content */
            }
            .user-stats-table th, .user-stats-table td {
                padding: 0.6rem 0.3rem; /* Adjusted cell padding */
                font-size: 0.75rem; /* Reduce font size */
            }
            /* On 768px and below, headers left-align, cell content left-align, but message count centered */
            .user-stats-table td {
                text-align: left;
            }
            .user-stats-table .message-count-col {
                text-align: center; /* Message count centered on 768px */
            }

            .action-button {
                padding: 9px 16px; /* Adjusted padding */
                font-size: 0.9rem;
            }
            .action-buttons-container { /* Action buttons container uses flex on mobile */
                display: flex;
                flex-wrap: wrap; 
                justify-content: center; 
                gap: 10px; 
            }
            .action-buttons-container .action-button { /* Button width adjustment */
                width: calc(50% - 10px); /* Two buttons per row, accounting for gap */
                min-width: 160px; /* Adjusted min-width */
                margin: 5px 0; /* Remove L/R margin, controlled by gap */
            }
            
            /* Responsive adjustments for even smaller screens */
            @media (max-width: 480px) {
                .action-buttons-container .action-button {
                    width: 90%; /* Buttons take more width */
                }
                .user-stats-table { /* Table converts to card-like list */
                    display: block; 
                    overflow-x: auto; 
                }
                .user-stats-table th, .user-stats-table td {
                    white-space: normal; 
                }
                .user-stats-table thead, .user-stats-table tbody, .user-stats-table tr {
                    display: block; 
                }
                .user-stats-table tr {
                    border-bottom: 1px solid var(--bg-tertiary); 
                }
                .user-stats-table tr:last-child {
                    border-bottom: none;
                }
                .user-stats-table th {
                    display: none; 
                }
                .user-stats-table td {
                    display: block; 
                    text-align: left; /* Cell content (value after label) left-aligned at 480px */
                    border-bottom: none; 
                    padding-left: 0.5rem; 
                }
                .user-stats-table td.message-count-col {
                     text-align: left; /* Ensure message count is also left-aligned at 480px */
                }
                .user-stats-table td::before { 
                    content: attr(data-label); 
                    font-weight: 500; /* Use medium weight for labels */
                    display: inline-block; /* Allows label and value on same line if space permits */
                    width: 90px; /* Adjusted label width */
                    margin-right: 10px; /* Spacing between label and value */
                    color: var(--text-primary);
                    text-align: left; /* Label text itself left-aligned */
                }
            }
        }
        #feedback-message { /* Action feedback message style */
            text-align: center;
            margin-top: 15px; /* Increased margin */
            font-weight: 500;
            font-size: 0.9rem;
        }
        #feedback-message.success {
            color: #34c759; /* Apple green */
        }
        #feedback-message.error {
            color: #ff3b30; /* Apple red */
        }
    </style>
</head>
<body>
    <div id="report-content-wrapper">
        <div class="grid-container">
            <div class="card main-card">
                <h1 contenteditable="true">[主报告标题 - 例如：AI产品团日报]</h1>
                <div class="date">[日期 - 例如：2025年5月19日]</div>
                <div class="meta-info">
                    <span><i class="fas fa-comment"></i> 消息数: [数字]+</span>
                    <span><i class="fas fa-users"></i> 活跃用户: [数字]+</span>
                    <span><i class="fas fa-fire"></i> 热点话题: [数字]</span>
                </div>
                <p class="summary">[在此处填写当日讨论的总体摘要。保持简洁明了，突出群组的主要主题和氛围。]</p>
                <i class="fas fa-microchip card-icon"></i> </div>

            <div class="topic-cards-wrapper">
                <div class="card topic-card">
                    <div class="topic-card-content-wrapper"> 
                        <h2 contenteditable="true"><i class="fas fa-lightbulb"></i> [主题1标题]</h2>
                        <div class="topic-category">[分类1 - 例如：工具技巧]</div>
                        <p>关于<span class="highlight-keyword">插件功能</span>的讨论，特别是<span class="highlight-name">@用户A</span>提到的<span class="highlight-keyword">上下文处理</span>能力。</p>
                        <div class="topic-keywords">
                            <span class="keyword">[关键词1A]</span>
                            <span class="keyword">[关键词1B]</span>
                            <span class="keyword">[关键词1C]</span>
                        </div>
                        <div class="topic-mentions"><i class="fas fa-bullhorn"></i> 提及次数: [数量1]</div>
                    </div>
                    <i class="fas fa-tools card-icon"></i> </div>

                <div class="card topic-card">
                    <div class="topic-card-content-wrapper"> 
                        <h2 contenteditable="true"><i class="fas fa-rocket"></i> [主题2标题]</h2>
                        <div class="topic-category">[分类2 - 例如：新功能]</div>
                        <p><span class="highlight-name">@用户B</span>分享了<span class="highlight-keyword">AI搜索</span>的最新进展和<span class="highlight-keyword">地区限制</span>问题。</p>
                        <div class="topic-keywords">
                            <span class="keyword">[关键词2A]</span>
                            <span class="keyword">[关键词2B]</span>
                        </div>
                        <div class="topic-mentions"><i class="fas fa-bullhorn"></i> 提及次数: [数量2]</div>
                    </div>
                    <i class="fas fa-star card-icon"></i> </div>
                
                <div class="card topic-card">
                    <div class="topic-card-content-wrapper"> 
                        <h2 contenteditable="true"><i class="fas fa-comments-dollar"></i> [主题3标题]</h2>
                        <div class="topic-category">[分类3 - 例如：工具体验]</div>
                        <p>大家对<span class="highlight-keyword">Agent技术</span>的<span class="highlight-keyword">商业化前景</span>进行了探讨，<span class="highlight-name">@用户C</span>提出了独到见解。</p>
                        <div class="topic-keywords">
                            <span class="keyword">[关键词3A]</span>
                            <span class="keyword">[关键词3B]</span>
                            <span class="keyword">[关键词3C]</span>
                        </div>
                        <div class="topic-mentions"><i class="fas fa-bullhorn"></i> 提及次数: [数量3]</div>
                    </div>
                    <i class="fas fa-comments card-icon"></i> </div>
            </div>

            <div class="card quote-card">
                <h2 contenteditable="false"><i class="fas fa-quote-left"></i> 精彩引用</h2>
                <div class="quote">
                    "[引言1内容。使其具有影响力或代表性。]"
                    <div class="quote-author">- @[发言人1]</div>
                </div>
                <div class="quote">
                    "[引言2内容。]"
                    <div class="quote-author">- @[发言人2]</div>
                </div>
                <div class="quote">
                    "[引言3内容。]"
                    <div class="quote-author">- @[发言人3]</div>
                </div>
                <i class="fas fa-comment-dots card-icon"></i> </div>

            <div class="card links-card">
                <h2 contenteditable="false"><i class="fas fa-link"></i> 重要链接与资源</h2>
                <div class="link-item">
                    <a href="[URL链接1]" target="_blank">
                        <i class="fas fa-external-link-alt link-icon"></i> 
                        <span class="link-title is-link">[链接1标题]</span>
                    </a>
                </div>
                <div class="link-item">
                    <a href="[URL链接2]" target="_blank">
                        <i class="fas fa-external-link-alt link-icon"></i>
                        <span class="link-title is-link">[链接2标题]</span>
                    </a>
                </div>
                <div class="link-item"> <i class="fas fa-file link-icon"></i> 
                    <span class="link-title">[文档1标题 - 例如：共享提示词V5]</span> 
                </div>
                <i class="fas fa-share-alt card-icon"></i> </div>

            <div class="card stats-card">
                <h2 contenteditable="false"><i class="fas fa-chart-line"></i> 活跃之星</h2>
                <table class="user-stats-table">
                    <thead>
                        <tr>
                            <th class="user-name-col">用户</th>
                            <th class="message-count-col">发言数</th>
                            <th class="contribution-col">主要贡献</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-label="用户" class="user-name-col">@发言人1</td>
                            <td data-label="发言数" class="message-count-col">[数量1]+</td>
                            <td data-label="主要贡献" class="contribution-col">[用户1的主要贡献内容 - 例如：分享 PageTalk 插件和万能 Prompt 生成器]</td>
                        </tr>
                        <tr>
                            <td data-label="用户" class="user-name-col">@发言人2</td>
                            <td data-label="发言数" class="message-count-col">[数量2]+</td>
                            <td data-label="主要贡献" class="contribution-col">[用户2的主要贡献内容 - 例如：PageTalk 插件开发者，分享使用体验]</td>
                        </tr>
                        <tr>
                            <td data-label="用户" class="user-name-col">@发言人3</td>
                            <td data-label="发言数" class="message-count-col">[数量3]+</td>
                            <td data-label="主要贡献" class="contribution-col">[用户3的主要贡献内容 - 例如：参与 Agent 讨论和工具测试]</td>
                        </tr>
                    </tbody>
                </table>
                <i class="fas fa-user-friends card-icon"></i> </div>

            <div class="card wordcloud-card">
                <h2 contenteditable="false"><i class="fas fa-cloud"></i> 词云</h2>
                <div class="wordcloud">
                    <span class="wordcloud-item size-5">[关键词A]</span>
                    <span class="wordcloud-item size-5">[关键词B]</span>
                    <span class="wordcloud-item size-4">[关键词C]</span>
                    <span class="wordcloud-item size-4">[关键词D]</span>
                    <span class="wordcloud-item size-3">[关键词E]</span>
                    <span class="wordcloud-item size-3">[关键词F]</span>
                    <span class="wordcloud-item size-2">[关键词G]</span>
                    <span class="wordcloud-item size-2">[关键词H]</span>
                    <span class="wordcloud-item size-1">[关键词I]</span>
                </div>
                <i class="fas fa-tags card-icon"></i> </div>
        </div> 
        
        <div class="footer">
            <p>数据来源：[您的数据来源 - 例如：AI产品团聊天记录] | 生成日期：[生成日期] | 统计周期：[统计周期 - 例如：[日期]全天]</p>
            <p>[免责声明 - 例如：本报告由AI自动生成，仅供参考，不代表所有群成员观点。]</p>
        </div>
    </div> 

    <div class="action-buttons-container">
        <button id="viewPreviousReportBtn" class="action-button"><i class="fas fa-calendar-alt"></i> 查看昨日日报</button>
        <button id="screenshotToClipboardBtn" class="action-button"><i class="fas fa-clipboard"></i> 拷贝截图</button>
        <button id="screenshotDownloadBtn" class="action-button"><i class="fas fa-camera"></i> 下载截图</button>
        <button id="copyHtmlBtn" class="action-button"><i class="fas fa-copy"></i> 拷贝源码</button>
        <button id="downloadHtmlBtn" class="action-button"><i class="fas fa-download"></i> 下载报告</button>
    </div>
    <div id="feedback-message"></div>

<script>
    // Helper function: Get CSS variable value
    function getCssVariable(variableName, defaultValue = null) {
        const value = getComputedStyle(document.documentElement).getPropertyValue(variableName).trim();
        return value || defaultValue;
    }

    // =====================================================================================
    // Filename generation helper functions
    // =====================================================================================
    function getWebpageNameForFilename() {
        const pageTitleTag = document.querySelector('title');
        let baseName = 'AI产品日报'; // Default name if title is empty or not as expected
        if (pageTitleTag && pageTitleTag.textContent) {
            const fullTitle = pageTitleTag.textContent.trim();
            const titleParts = fullTitle.split(' - '); // Split by " - "
            if (titleParts.length > 0 && titleParts[0].trim() !== "" && titleParts[0].trim() !== "[在此处填写报告标题]") {
                baseName = titleParts[0].trim(); 
            }
        }
        return baseName;
    }

    function getDateStringForFilename() {
        const reportDateElement = document.querySelector('.main-card .date');
        let dateStr = "未指定日期"; // Default date if element is empty
        if (reportDateElement && reportDateElement.textContent) {
            const dateContent = reportDateElement.textContent.trim();
            if (dateContent && dateContent !== "[日期 - 例如：2025年5月19日]") { // Ensure content is not empty or placeholder
                dateStr = dateContent;
            }
        }
        return dateStr;
    }
    
    function sanitizeFilename(filename) {
        // Remove or replace unsuitable characters in filename
        // Allows Chinese, alphanumeric, underscore, hyphen, dot, and placeholder brackets
        return filename.replace(/[^a-z0-9\u4e00-\u9fa5_\-\.\(\)\[\]]/gi, '_').replace(/_+/g, '_');
    }


    // =====================================================================================
    // Configure URL for "View Previous Report" button here
    // =====================================================================================
    const previousReportUrl = "在此处填写昨日日报的URL"; // IMPORTANT: Update this URL

    // Function to display feedback messages to the user
    function showFeedbackMessage(message, type = 'info', duration = 3000) {
        const feedbackElement = document.getElementById('feedback-message');
        if (feedbackElement) {
            feedbackElement.textContent = message;
            feedbackElement.className = type; // Apply 'success' or 'error' class for styling
            setTimeout(() => {
                feedbackElement.textContent = '';
                feedbackElement.className = '';
            }, duration);
        }
    }
    
    // Screenshot function using html2canvas
    async function captureScreenshot(elementToCapture) {
        await document.fonts.ready; // Ensure fonts are loaded before screenshot
        
        // Scroll to the top of the window before taking the screenshot
        window.scrollTo(0, 0);
        // Add a small delay to ensure the browser has time to re-render after scroll
        await new Promise(resolve => setTimeout(resolve, 100)); // 100ms delay

        return html2canvas(elementToCapture, { 
            useCORS: true, 
            scale: window.devicePixelRatio || 1, 
            logging: false, 
            backgroundColor: getCssVariable('--bg-primary', '#f9f9f9'), 
            // Removed scrollX, scrollY, windowWidth, windowHeight
            // Let html2canvas determine the bounds of the elementToCapture after scrolling to top
        });
    }

    // "Copy Screenshot" button event
    document.getElementById('screenshotToClipboardBtn').addEventListener('click', async function() {
        const reportContent = document.getElementById('report-content-wrapper');
        if (!reportContent) {
            showFeedbackMessage('截图错误: 未找到报告内容。', 'error');
            return;
        }
        const actionButtons = document.querySelector('.action-buttons-container');
        const feedbackMsgElement = document.getElementById('feedback-message');
        const originalButtonText = this.innerHTML;
        this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 处理中...';
        this.disabled = true;
        actionButtons.style.visibility = 'hidden'; // Hide buttons during screenshot
        if(feedbackMsgElement) feedbackMsgElement.style.visibility = 'hidden'; // Hide feedback during screenshot

        try {
            const canvas = await captureScreenshot(reportContent);
            canvas.toBlob(async function(blob) {
                if (blob) {
                    try {
                        if (navigator.clipboard && navigator.clipboard.write) {
                            await navigator.clipboard.write([
                                new ClipboardItem({ 'image/png': blob })
                            ]);
                            showFeedbackMessage('截图已拷贝到剪贴板!', 'success');
                        } else {
                            // Fallback or error handling for browsers not supporting Clipboard API for images
                            showFeedbackMessage('截图已生成，但您的浏览器不支持直接拷贝图片。请尝试下载截图。', 'error', 5000);
                        }
                    } catch (copyError) {
                        console.error('拷贝到剪贴板失败:', copyError);
                        // Updated error handling for NotAllowedError
                        if (copyError.name === 'NotAllowedError') {
                            showFeedbackMessage('无法拷贝截图：剪贴板权限被阻止。请尝试下载截图。', 'error', 6000);
                        } else {
                            showFeedbackMessage('拷贝截图到剪贴板失败。请尝试下载。', 'error', 5000);
                        }
                    }
                } else {
                    throw new Error('无法将Canvas转换为Blob。');
                }
            }, 'image/png');
        } catch (error) {
            console.error('截图捕获失败:', error);
            showFeedbackMessage('截图捕获失败: ' + error.message, 'error');
        } finally {
            actionButtons.style.visibility = 'visible'; // Restore buttons
            if(feedbackMsgElement) feedbackMsgElement.style.visibility = 'visible'; // Restore feedback
            this.innerHTML = originalButtonText;
            this.disabled = false;
        }
    });

    // "Download Screenshot" button event
    document.getElementById('screenshotDownloadBtn').addEventListener('click', async function() {
        const reportContent = document.getElementById('report-content-wrapper');
        if (!reportContent) {
            showFeedbackMessage('截图错误: 未找到报告内容。', 'error');
            return;
        }
        const actionButtons = document.querySelector('.action-buttons-container');
        const feedbackMsgElement = document.getElementById('feedback-message');
        const originalButtonText = this.innerHTML;
        this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 生成中...';
        this.disabled = true;
        actionButtons.style.visibility = 'hidden';
        if(feedbackMsgElement) feedbackMsgElement.style.visibility = 'hidden';

        try {
            const canvas = await captureScreenshot(reportContent);
            const image = canvas.toDataURL('image/png');
            const link = document.createElement('a');
            
            const webpageName = getWebpageNameForFilename();
            const dateString = getDateStringForFilename();
            let filename = sanitizeFilename(webpageName + '-' + dateString) + '.png';

            link.href = image;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            showFeedbackMessage('截图已下载!', 'success');
        } catch (error) {
            console.error('下载截图失败:', error);
            showFeedbackMessage('下载截图失败: ' + error.message, 'error');
        } finally {
            actionButtons.style.visibility = 'visible';
            if(feedbackMsgElement) feedbackMsgElement.style.visibility = 'visible';
            this.innerHTML = originalButtonText;
            this.disabled = false;
        }
    });

    // "Download Report" (HTML) button event
    document.getElementById('downloadHtmlBtn').addEventListener('click', function() {
        try {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
            const link = document.createElement('a');
            
            const webpageName = getWebpageNameForFilename();
            const dateString = getDateStringForFilename();
            let filename = sanitizeFilename(webpageName + '-' + dateString) + '.html';
            
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(link.href); 
            showFeedbackMessage('HTML报告已下载!', 'success');
        } catch (error) {
            console.error('下载HTML失败:', error);
            showFeedbackMessage('下载HTML失败: ' + error.message, 'error');
        }
    });

    // "Copy Source Code" button event
    document.getElementById('copyHtmlBtn').addEventListener('click', function() {
        const htmlContent = document.documentElement.outerHTML;
        const Gthis = this; // 'this' context of the button
        const originalButtonHTML = Gthis.innerHTML; // Save original button content
        const textarea = document.createElement('textarea');
        textarea.value = htmlContent;
        textarea.style.position = 'fixed'; // Prevent display on screen
        textarea.style.top = '-9999px'; 
        textarea.style.left = '-9999px';
        document.body.appendChild(textarea);
        try {
            textarea.select();
            textarea.setSelectionRange(0, textarea.value.length); // For mobile devices
            if (document.execCommand('copy')) {
                Gthis.innerHTML = '<i class="fas fa-check"></i> 已拷贝!';
                showFeedbackMessage('HTML已拷贝到剪贴板!', 'success', 2000);
            } else {
                Gthis.innerHTML = '<i class="fas fa-times"></i> 拷贝失败';
                showFeedbackMessage('拷贝失败。您的浏览器可能不支持此操作。', 'error', 2000);
            }
        } catch (err) {
            Gthis.innerHTML = '<i class="fas fa-times"></i> 拷贝出错';
            showFeedbackMessage('拷贝出错: ' + err.message, 'error', 2000);
            console.error('拷贝HTML源码出错:', err);
        } finally {
            setTimeout(function() { // Restore button text after a delay
                Gthis.innerHTML = originalButtonHTML; 
            }, 2000);
            document.body.removeChild(textarea);
        }
    });

    // "View Previous Report" button event
    document.getElementById('viewPreviousReportBtn').addEventListener('click', function() {
        const urlToOpen = previousReportUrl.trim();
        const placeholderUrlText = "在此处填写昨日日报的URL"; // Placeholder text
        if (urlToOpen && urlToOpen !== placeholderUrlText && (urlToOpen.startsWith('http://') || urlToOpen.startsWith('https://') || !urlToOpen.includes('://'))) {
            let finalUrl = urlToOpen;
            // No need to add 'http://' if it's a relative path or already has a protocol
            const newWindow = window.open(finalUrl, '_blank'); // Open in a new tab
            if (!newWindow || newWindow.closed || typeof newWindow.closed == 'undefined') {
                // This might happen if pop-ups are blocked
                showFeedbackMessage('无法打开新窗口。请检查您的弹出窗口拦截设置。', 'error', 5000);
            }
        } else {
            showFeedbackMessage('昨日日报的URL未配置或无效。请检查脚本中的 previousReportUrl 变量，并确保它是一个有效的网址或相对路径。', 'error', 5000);
        }
    });

    // Adjust action buttons layout based on window size
    function adjustActionButtonsLayout() {
        const actionButtonsContainer = document.querySelector('.action-buttons-container');
        if (actionButtonsContainer) {
            if (window.innerWidth <= 768) { // Corresponds to @media (max-width: 768px)
                actionButtonsContainer.style.display = 'flex';
                actionButtonsContainer.style.flexWrap = 'wrap';
                actionButtonsContainer.style.justifyContent = 'center';
            } else { // Desktop layout
                actionButtonsContainer.style.display = 'block'; 
                actionButtonsContainer.style.flexWrap = 'nowrap'; 
            }
        }
    }
    window.addEventListener('load', adjustActionButtonsLayout);
    window.addEventListener('resize', adjustActionButtonsLayout);

</script>
</body>
</html>